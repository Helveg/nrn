Last year I followed the windows build process. I don't have detailed instructions (yet) but uploading screenshots that I took step-by-step:

### Configuration of VirtualBox with Windows 
<img width="1403" alt="Screenshot 2019-11-14 at 13 58 57" src="https://user-images.githubusercontent.com/666852/82117221-17855700-976f-11ea-8a3e-b4c85332ece6.png">
<img width="1406" alt="Screenshot 2019-11-14 at 13 59 30" src="https://user-images.githubusercontent.com/666852/82117224-1d7b3800-976f-11ea-93b6-78b1ab1b1f07.png">
<img width="1407" alt="Screenshot 2019-11-14 at 13 59 46" src="https://user-images.githubusercontent.com/666852/82117226-1fdd9200-976f-11ea-8d84-98e483873568.png">
<img width="1406" alt="Screenshot 2019-11-14 at 13 59 54" src="https://user-images.githubusercontent.com/666852/82117227-21a75580-976f-11ea-8a04-7387bf303506.png">
<img width="1403" alt="Screenshot 2019-11-14 at 14 00 04" src="https://user-images.githubusercontent.com/666852/82117229-22d88280-976f-11ea-8a6a-0c6baa89c79f.png">
<img width="1404" alt="Screenshot 2019-11-14 at 14 00 20" src="https://user-images.githubusercontent.com/666852/82117232-24a24600-976f-11ea-9d31-b338da0696a7.png">
<img width="1406" alt="Screenshot 2019-11-14 at 14 00 36" src="https://user-images.githubusercontent.com/666852/82117233-25d37300-976f-11ea-8dce-2d57b976a581.png">
<img width="1402" alt="Screenshot 2019-11-14 at 14 01 20" src="https://user-images.githubusercontent.com/666852/82117234-2835cd00-976f-11ea-82ad-40cf390511df.png">
<img width="1401" alt="Screenshot 2019-11-14 at 14 01 30" src="https://user-images.githubusercontent.com/666852/82117237-2bc95400-976f-11ea-996b-c33ab6a1bda5.png">

### Visual Studio Installation
<img width="1345" alt="Screenshot 2019-11-17 at 15 42 29" src="https://user-images.githubusercontent.com/666852/82117239-2e2bae00-976f-11ea-8303-fd054364857c.png">
<img width="1311" alt="Screenshot 2019-11-17 at 15 43 45" src="https://user-images.githubusercontent.com/666852/82117240-2f5cdb00-976f-11ea-80b0-ae1f6339fba5.png">
<img width="1352" alt="Screenshot 2019-11-17 at 15 48 57" src="https://user-images.githubusercontent.com/666852/82117241-31269e80-976f-11ea-8fe1-4edd3632854a.png">

### MSYS2 Installation
<img width="1331" alt="Screenshot 2019-11-17 at 17 18 43" src="https://user-images.githubusercontent.com/666852/82117246-3257cb80-976f-11ea-963f-891d506a54fc.png">
<img width="1299" alt="Screenshot 2019-11-17 at 17 20 06" src="https://user-images.githubusercontent.com/666852/82117248-34ba2580-976f-11ea-8b3d-b70b39b6968f.png">
<img width="1312" alt="Screenshot 2019-11-17 at 17 20 25" src="https://user-images.githubusercontent.com/666852/82117250-3683e900-976f-11ea-88d7-fab1f427932d.png">
<img width="1400" alt="Screenshot 2019-11-17 at 17 24 55" src="https://user-images.githubusercontent.com/666852/82117255-3b489d00-976f-11ea-98a7-cb512160b74d.png">
<img width="1314" alt="Screenshot 2019-11-18 at 13 11 30" src="https://user-images.githubusercontent.com/666852/82117284-4bf91300-976f-11ea-8f58-b08e85c544c5.png">

### MSYS2 Package Installation Using Pacman
<img width="1404" alt="Screenshot 2019-11-17 at 17 23 35" src="https://user-images.githubusercontent.com/666852/82117252-397ed980-976f-11ea-9bf7-82f9a8721759.png">
<img width="1403" alt="Screenshot 2019-11-17 at 17 25 57" src="https://user-images.githubusercontent.com/666852/82117261-3edc2400-976f-11ea-94f2-d017dbb0edab.png">
<img width="1410" alt="Screenshot 2019-11-17 at 17 30 13" src="https://user-images.githubusercontent.com/666852/82117263-3f74ba80-976f-11ea-9886-73bdf0841d88.png">
<img width="1408" alt="Screenshot 2019-11-17 at 17 33 55" src="https://user-images.githubusercontent.com/666852/82117265-400d5100-976f-11ea-8c6f-0addd145b901.png">

### Microsoft MPI and MPI SDK Installation
<img width="1316" alt="Screenshot 2019-11-17 at 17 40 39" src="https://user-images.githubusercontent.com/666852/82117267-40a5e780-976f-11ea-9265-d97be452eb41.png">
<img width="1315" alt="Screenshot 2019-11-17 at 17 40 54" src="https://user-images.githubusercontent.com/666852/82117268-41d71480-976f-11ea-94fc-c41a4e165024.png">
<img width="1332" alt="Screenshot 2019-11-17 at 17 42 11" src="https://user-images.githubusercontent.com/666852/82117269-41d71480-976f-11ea-949e-5a9bf98cbc44.png">
<img width="1308" alt="Screenshot 2019-11-17 at 17 42 27" src="https://user-images.githubusercontent.com/666852/82117271-43084180-976f-11ea-824a-ae3420945232.png">
<img width="1290" alt="Screenshot 2019-11-17 at 17 43 17" src="https://user-images.githubusercontent.com/666852/82117272-43a0d800-976f-11ea-8275-46427d3291b3.png">
<img width="1340" alt="Screenshot 2019-11-17 at 17 57 59" src="https://user-images.githubusercontent.com/666852/82117273-43a0d800-976f-11ea-8c0f-709e75d7b522.png">
<img width="1340" alt="Screenshot 2019-11-17 at 17 58 16" src="https://user-images.githubusercontent.com/666852/82117274-456a9b80-976f-11ea-9ac5-ef6b2d615dc5.png">

### Python Installation
<img width="1362" alt="Screenshot 2019-11-18 at 13 05 07" src="https://user-images.githubusercontent.com/666852/82117276-469bc880-976f-11ea-91cd-6a13ca577a49.png">
<img width="1345" alt="Screenshot 2019-11-18 at 13 05 52" src="https://user-images.githubusercontent.com/666852/82117277-48658c00-976f-11ea-91a4-62fdcae3d404.png">
<img width="1297" alt="Screenshot 2019-11-18 at 13 07 31" src="https://user-images.githubusercontent.com/666852/82117278-48fe2280-976f-11ea-98da-6ac6868063d5.png">
<img width="1318" alt="Screenshot 2019-11-18 at 13 08 51" src="https://user-images.githubusercontent.com/666852/82117280-4a2f4f80-976f-11ea-9efa-0e859b46924c.png">


### NEURON Repository Clone
<img width="1389" alt="Screenshot 2019-11-18 at 13 15 51" src="https://user-images.githubusercontent.com/666852/82117285-4c91a980-976f-11ea-9716-4c565dfb88b2.png">
<img width="1393" alt="Screenshot 2019-11-18 at 13 17 13" src="https://user-images.githubusercontent.com/666852/82117286-4d2a4000-976f-11ea-9475-fce3c74cd6c4.png">

### Realised CMake was missing
<img width="1390" alt="Screenshot 2019-11-18 at 13 22 06" src="https://user-images.githubusercontent.com/666852/82117288-4d2a4000-976f-11ea-82c3-200901a80a26.png">

### Trying to build NEURON
<img width="1402" alt="Screenshot 2019-11-18 at 13 33 02" src="https://user-images.githubusercontent.com/666852/82117291-4dc2d680-976f-11ea-9d20-332f2e7b4217.png">
<img width="1398" alt="Screenshot 2019-11-18 at 13 33 29" src="https://user-images.githubusercontent.com/666852/82117292-4e5b6d00-976f-11ea-9fa1-99de18c000d6.png">
<img width="1400" alt="Screenshot 2019-11-18 at 13 35 58" src="https://user-images.githubusercontent.com/666852/82117293-4e5b6d00-976f-11ea-88a5-467d5857f540.png">

### Readline and ncurses was missing
<img width="1397" alt="Screenshot 2019-11-18 at 13 50 18" src="https://user-images.githubusercontent.com/666852/82117294-4ef40380-976f-11ea-865d-edc1eede9d4b.png">
<img width="1391" alt="Screenshot 2019-11-18 at 14 24 59" src="https://user-images.githubusercontent.com/666852/82117295-4ef40380-976f-11ea-80f5-9dad82ea7286.png">

### Trying to build again
<img width="1404" alt="Screenshot 2019-11-18 at 14 55 16" src="https://user-images.githubusercontent.com/666852/82117297-4f8c9a00-976f-11ea-9cd2-bbaed48a66a0.png">
<img width="1397" alt="Screenshot 2019-11-18 at 14 59 58" src="https://user-images.githubusercontent.com/666852/82117298-50253080-976f-11ea-948e-172f6e5c3d67.png">

### Cython was missing
<img width="1391" alt="Screenshot 2019-11-18 at 15 03 22" src="https://user-images.githubusercontent.com/666852/82117299-51565d80-976f-11ea-8eaf-3428df55b847.png">

### Trying to build again, distutils is not updated for newer visual studio toolchain
<img width="1394" alt="Screenshot 2019-11-18 at 15 13 16" src="https://user-images.githubusercontent.com/666852/82117301-51eef400-976f-11ea-9b3f-f457340ea2f9.png">

### Manually modify cygwincompiler.py
<img width="1387" alt="Screenshot 2019-11-18 at 15 14 48" src="https://user-images.githubusercontent.com/666852/82117303-52878a80-976f-11ea-8d75-ccbe96639c96.png">

### Finally managed to complete CMake configure stage
<img width="1411" alt="Screenshot 2019-11-18 at 15 19 22" src="https://user-images.githubusercontent.com/666852/82117304-53202100-976f-11ea-8633-f282f42ec000.png">

### Trying to build the project
<img width="1304" alt="Screenshot 2019-11-18 at 15 20 37" src="https://user-images.githubusercontent.com/666852/82117306-54514e00-976f-11ea-837b-56a2226cb747.png">
<img width="1330" alt="Screenshot 2019-11-18 at 15 25 56" src="https://user-images.githubusercontent.com/666852/82117307-54514e00-976f-11ea-8423-a4dcb126a084.png">


### TODO : Additional changes missing here!


## Automated Installation

* Right Click on Start button and Open PowerShell with Admin Permission

* Powershell command to install chocolatey

```
Set-ExecutionPolicy Bypass -Scope Process -Force; [System.Net.ServicePointManager]::SecurityProtocol = [System.Net.ServicePointManager]::SecurityProtocol -bor 3072; iex ((New-Object System.Net.WebClient).DownloadString('https://chocolatey.org/install.ps1'))
```

* Install Powershell

```
https://github.com/PowerShell/PowerShell/releases/download/v7.0.1/PowerShell-7.0.1-win-x64.msi
```

* Start command as an administrator

* Set env variables

```
set MSYS2_ARCH=x86_64
set MSYS2_ROOT=C:\msys64
set COMPILER=gcc
```

* Install Visual Studio 2019

https://docs.microsoft.com/en-us/visualstudio/install/create-an-offline-installation-of-visual-studio?view=vs-2019

```
## choco install visualstudio2019community --package-parameters "--allWorkloads --includeRecommended --includeOptional --passive --locale en-US"

Invoke-Webrequest -uri "https://download.visualstudio.microsoft.com/download/pr/9fcc1f0c-c63f-4424-bc46-7351a59fba06/1ed7863dc633c57c42a88c5cef907048/vs_community.exe" -OutFile vs_community.exe

#.\vs.exe --layout c:\vslayout --add Microsoft.VisualStudio.Workload.NativeDesktop --includeRecommended --lang en-US
#C:\vslayout\vs.exe --add Microsoft.VisualStudio.Workload.NativeDesktop --includeRecommended
#.\vs.exe --add Microsoft.VisualStudio.Workload.NativeDesktop --add Microsoft.VisualStudio.Component.VC.140 --includeRecommended
.\vs_community.exe --add Microsoft.VisualStudio.Workload.NativeDesktop --add Microsoft.VisualStudio.Component.VC.140 --add Microsoft.VisualStudio.Component.Windows10SDK.17763

Just clck iinstall when dialog opens
```

```
 Get-ChildItem -Path 'C:\Program Files (x86)\Microsoft Visual Studio 14.0\' -Filter vcvarsall.bat -Recurse -ErrorAction SilentlyContinue -Force
 
 

    Directory: C:\Program Files (x86)\Microsoft Visual Studio 14.0\VC


Mode                LastWriteTime         Length Name
----                -------------         ------ ----
-ar---       10/29/2018   1:53 PM           3600 vcvarsall.bat
```

```
PS C:\Users\kumbhar> ls -l 'C:\Program Files (x86)\Microsoft Visual Studio 14.0\VC\'


    Directory: C:\Program Files (x86)\Microsoft Visual Studio 14.0\VC


Mode                LastWriteTime         Length Name
----                -------------         ------ ----
d-----        5/22/2020  12:53 PM                atlmfc
d-----        5/22/2020  12:54 PM                bin
d-----        5/22/2020  12:53 PM                crt
d-----        5/22/2020  12:54 PM                include
d-----        5/22/2020  12:54 PM                lib
d-----        5/22/2020  12:53 PM                redist
d-----        5/22/2020  12:53 PM                UnitTest
-ar---       10/29/2018   1:53 PM           3600 vcvarsall.bat


PS C:\Users\kumbhar> ls -l 'C:\Program Files (x86)\Windows Kits\10\'


    Directory: C:\Program Files (x86)\Windows Kits\10


Mode                LastWriteTime         Length Name
----                -------------         ------ ----
d-----        5/22/2020  12:51 PM                App Certification Kit
d-----        5/22/2020  12:51 PM                bin
d-----        5/22/2020  12:53 PM                Catalogs
d-----        5/22/2020  12:51 PM                DesignTime
d-----        5/22/2020  12:52 PM                Extension SDKs
d-----        5/22/2020  12:53 PM                Include
d-----        5/22/2020  12:53 PM                Lib
d-----        5/22/2020  12:51 PM                Licenses
d-----        5/22/2020  12:51 PM                Platforms
d-----        5/22/2020  12:51 PM                Redist
d-----        5/22/2020  12:51 PM                References
d-----        5/22/2020  12:52 PM                Remote
d-----        5/22/2020  12:51 PM                Shortcuts
d-----        5/22/2020  12:53 PM                Source
d-----        5/22/2020  12:51 PM                Testing
d-----        5/22/2020  12:51 PM                UnionMetadata
-a----        3/18/2019   5:25 PM            421 SDKManifest.xml

PS C:\Users\kumbhar> ls -l 'C:\Program Files (x86)\MSBuild\'


    Directory: C:\Program Files (x86)\MSBuild


Mode                LastWriteTime         Length Name
----                -------------         ------ ----
d-----        5/22/2020  12:48 PM                15.0
d-----        5/22/2020  12:53 PM                Microsoft.Cpp
```

* Install msys2

```
 choco install -y msys2
```


* Install Pacmand Packages

```
%MSYS2_ROOT%\usr\bin\pacman --noconfirm --needed -S git zip unzip base-devel mingw-w64-$(MSYS2_ARCH)-cmake mingw-w64-$(MSYS2_ARCH)-ncurses mingw-w64-$(MSYS2_ARCH)-readline mingw-w64-$(MSYS2_ARCH)-cython3 %TOOLCHAIN%
```

```
set HTTP_RETRIES=3

echo "Install MS-MPI"

::pwsh -c Invoke-WebRequest -MaximumRetryCount %HTTP_RETRIES% -OutFile msmpisetup.exe https://download.microsoft.com/download/4/A/6/4A6AAED8-200C-457C-AB86-37505DE4C90D/msmpisetup.exe || goto :error
::pwsh -c Invoke-WebRequest -MaximumRetryCount %HTTP_RETRIES% -OutFile msmpisdk.msi https://download.microsoft.com/download/4/A/6/4A6AAED8-200C-457C-AB86-37505DE4C90D/msmpisdk.msi || goto :error
msmpisetup.exe -unattend -installroot C:\ms-mpi || goto :error
msmpisdk.msi /passive || goto :error


::pwsh -c Invoke-WebRequest -MaximumRetryCount %HTTP_RETRIES% -OutFile python-3.5.4.exe https://www.python.org/ftp/python/3.5.4/python-3.5.4-amd64.exe || goto :error
::pwsh -c Invoke-WebRequest -MaximumRetryCount %HTTP_RETRIES% -OutFile python-3.6.8.exe https://www.python.org/ftp/python/3.6.8/python-3.6.8-amd64.exe || goto :error
::pwsh -c Invoke-WebRequest -MaximumRetryCount %HTTP_RETRIES% -OutFile python-3.7.7.exe https://www.python.org/ftp/python/3.7.7/python-3.7.7-amd64.exe || goto :error
::pwsh -c Invoke-WebRequest -MaximumRetryCount %HTTP_RETRIES% -OutFile python-3.8.2.exe https://www.python.org/ftp/python/3.8.2/python-3.8.2-amd64.exe || goto :error
::python-3.5.4.exe /passive Include_pip=1 Include_test=0 PrependPath=1 DefaultJustForMeTargetDir=C:\python354
::python-3.6.8.exe /passive Include_pip=1 Include_test=0 PrependPath=1 DefaultJustForMeTargetDir=C:\python368
::python-3.7.7.exe /passive Include_pip=1 Include_test=0 PrependPath=1 DefaultJustForMeTargetDir=C:\python377
::python-3.8.2.exe /passive Include_pip=1 Include_test=0 PrependPath=1 DefaultJustForMeTargetDir=C:\python382

echo Install Python

:error
exit /b %errorlevel%
```

* Clone neuron repo

```
%MSYS2_ROOT%\usr\bin\bash -lc "git clone https://github.com/neuronsimulator/nrn"
```


```
sed -i "s/elif msc_ver == '1600':/elif msc_ver == '1900':/g" /c/python354/lib/distutils/cygwinccompiler.py
sed -i "s/elif msc_ver == '1600':/elif msc_ver == '1916':/g" /c/python368/lib/distutils/cygwinccompiler.py
sed -i "s/elif msc_ver == '1600':/elif msc_ver == '1900':/g" /c/python377/lib/distutils/cygwinccompiler.py
sed -i "s/elif msc_ver == '1600':/elif msc_ver == '1916':/g" /c/python382/lib/distutils/cygwinccompiler.py
sed -i "s/return \['msvcr100'\]/return \['msvcrt'\]/g" /c/python3*/lib/distutils/cygwinccompiler.py
```


```
   49  export MSMPI_INC=c:/ms-mpi/include/
   51  export MSMPILIB32=/c/ms-mpi/lib/x86/msmpi.lib
   52  export MSMPILIB64=/c/ms-mpi/lib/x64/msmpi.lib
```